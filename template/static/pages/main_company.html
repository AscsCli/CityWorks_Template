<!DOCTYPE html>
<head>
    <title>Hello World</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        body {
            background: #111e42;
        }

        .content {
            color: #93ccf5;
        }

        .content p {
            padding: 0 30px;
            height: 30px;
            line-height: 30px;
        }

        table {
            text-align: center;
            border-collapse: collapse;
        }

        table, th, td {
            /* border: 1px solid black;*/
        }

        th, td {
            height: 30px;
            line-height: 30px;
        }

        tbody tr {
            /* background: #E7F0FF;*/
        }
        #content{
            font-size: 14px;
            padding-top: 15px;
        }
        #ControlTitlebar {
            background: #213058;
            /*width: 400px;*/
            height: 30px;
            cursor: pointer;
        }

        #ButtonClose {
            width: 35px;
            height: 30px;
            line-height: 30px;
            font-size: 14px;
            float: right;
            margin-right: 2px;
            cursor: pointer;
            text-align: center;
            border-radius: 2px;
            background-color: #93ccf5;
            background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAkCAYAAACe0YppAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxNmFkNGM5Mi01MmUxLTRkMDgtYmQ0Mi1kZWFkNTQyOGM2Y2IiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkE5NTE0MDBGODFFMTFFNkIyODRCMzA2MUIyNThBRUYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkE5NTEzRkZGODFFMTFFNkIyODRCMzA2MUIyNThBRUYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6M0UxMkY0RjY1NUY3RTYxMTlGQkVGMkVCQjNCOTJDMDEiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpmNzllZGZlOC0xMzVlLTExN2EtYWQ5Yy05YmNhZGRhMTY0NjMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz51u3JTAAAAwUlEQVR42mL8//8/w0AAJoYBAqMWj1o8avGoxaMWEw1YiFU45ew3kCOFgPgNHmUiQPwux5jrHzV9LADEvUCsi0NeGyovQO2gfgfEPUBcArUE3dIyqPw7WsTxZajhZUiWI1t6mepxjMPydUAcRKqllKTqy1BL46D0ZXplJ22oTxdBaW16WIwcpxuxxDlNLMaWkC6TYzkpFgvhSb3IlgtRO1V/AOJiPCXXZaj8B2IMYxxtV49aPGrxqMWjFg96iwECDAA6Ei6bDoZZmgAAAABJRU5ErkJggg==");
        }

        #ButtonClose:hover {
            /*background: #FF3333;*/
        }

        div.buttonGroup {
            height: 60px;
            line-height: 60px;
            text-align: center;
        }

        input[type = button] {
            width: 120px;
            height: 30px;
            border-radius: 5px;
            color: #82CDF9;
            background-color: #182246;
        }
        input[type = button]:hover {
            color: #F4FAFF;
            background-color: #00AEFA;
        }
        div.windowTitle{
            display: inline-block;
        }
        div.windowTitle span{
            display: inline-block;
            line-height: 35px;
            height: 35px;
            color: #93ccf5;
            font-size: 16px;
            padding-left: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div>
    <div id="ControlTitlebar">
        <div class="windowTitle">
            <span id="windowName">企业名片</span>
        </div>
        <div id="ButtonClose"></div>
    </div>
    <div class="content-box">
        <!-- <table class="table table-hover table-bordered" style="width: 100%">
             <thead>
             <tr>
                 <th>名称</th>
                 <th>信息</th>
             </tr>
             </thead>
             <tbody id="bimTb">
             </tbody>
         </table>-->
        <div class="content" id="content"></div>
        <div class="buttonGroup">
            <input type="button" value="室内三维" onclick='run()'/>
            <input type="button" value="建筑档案册" onclick='book()'/>
        </div>
    </div>
</div>
</body>
<script type="text/javascript">
    var mapping = {
        "id": "ID",
        "credit_key": "信用编码",
        "tel_nbr": "法人电话",
        "address": "邮政编码",
        "main_name": "法人姓名",
        "latitude": "经度",
        "longitude": "纬度",
        "type": "企业类型",
        "org_name": "公司名称",
        "business": "经营范围"
    };
    //页面关闭
    window.onunload = function () {
        if (external.parentWindow.__g != undefined) {
            if (external.parentWindow.__g.featureManager != undefined) {
                external.parentWindow.__g.featureManager.unhighlightAll();
            }
            // external.parentWindow.__g.interactMode = gviInteractMode.gviInteractNormal;
        }
    };
    var href = location.href;
    var indexSingle = href.indexOf('?') + 1;
    var viewId = location.href.substring(indexSingle, href.length);
    //页面加载
    window.onload = function () {

        var propertyData = external.parentWindow.cwConfig.swap;
//        console.log(propertyData);
        if (propertyData === undefined) {
            return;
        }

        /*        var tbody = document.getElementById('bimTb');

                var tr = document.createElement("tr");*/

        var data = JSON.parse(propertyData);
        var windowTitle = document.getElementById("windowName");
        windowTitle.innerText = data.windowTitle || "重点建筑";
        var content = document.getElementById('content');
        for (var item in data) {
            if (data.hasOwnProperty(item)) {
                /*var tr = document.createElement("tr");
                var tdTitle = document.createElement("td");
                var tdValue = document.createElement("td");*/
                var temp = data[item];
                if (!temp || !item || item === "length" || item === "windowTitle") {
                    continue;
                }
                /*	tdTitle.innerHTML = item;
                    tdValue.innerHTML = temp;
                    tr.appendChild(tdTitle);
                    tr.appendChild(tdValue);
                    tbody.appendChild(tr);*/
                var p = document.createElement('p');
                p.innerHTML = mapping[item] + '&nbsp;&nbsp;&nbsp;&nbsp;' + temp;
                content.appendChild(p);
            }
        }
        //控制按钮显示隐藏操作
        var button = document.querySelector('.buttonGroup');
        if (!external.parentWindow.cwConfig.queryPageStyle.button.isHiddenButton) {
            button.style.display = 'none';
        }

    };

    function run(strPath) {
        try {
//              new ActiveXObject("Wscript.Shell").run("D:\\work\\works\\3dView\\"+ viewId + ".exe");
            new ActiveXObject("Wscript.Shell").run("D:\\work\\works\\3dView\\4403070090150400006.exe");
        }
        catch (e) {
            alert("D:\\work\\works\\3dView\\" + viewId + ".exe");
            alert("请确定路径和文件名是否正确")
        }
    }

    function book() {
        var url = "http://58.60.185.51:5759/xfyhpc-ps-web/system.do?toBuildInfoMoreNoLogin&buildid=" + viewId;
        window.open(url);
    }
</script>
</html>

